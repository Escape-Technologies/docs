---
title: Command Injection
---

# Command Injection

## Description

A system command was successfully executed on your application's system.
Command injections happen when a user manages to successfully execute arbitrary commands on the host's operating system by abusing a vulnerable endpoint.


## Remediation

To prevent command injection attacks:
- Never use user-submitted input in shell commands.
- If supported by your language, add `semgrep` to your development process to ensure detection of potentially vulnerable system shell calls.
- Use proper input validation techniques to detect and prevent command injection. Keep in mind the input validation should be implemented in the backend as it will be easily bypassed if done in the frontend.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

To prevent command injection in Apollo, validate and sanitize all user inputs. Use a whitelist approach for allowed operations, and avoid passing user input directly to any system command.

</details>

<details>
    <summary>Yoga</summary>

In Yoga, ensure that user inputs are strictly validated and sanitized. Avoid using any form of eval or system command with user input. Instead, use parameterized APIs or safe libraries designed for the task at hand.

</details>

<details>
    <summary>Awsappsync</summary>

For AWS AppSync, use VTL (Velocity Template Language) resolvers and avoid calling out to AWS Lambda functions that might execute system commands with user input. Always validate and sanitize input before using it in your resolvers.

</details>

<details>
    <summary>Graphqlgo</summary>

In GraphQL Go, validate all inputs using Go's strong typing and avoid using user input directly in any system commands. Use context-bound parameters and sanitize inputs.

</details>

<details>
    <summary>Graphqlruby</summary>

In GraphQL Ruby, use strong parameters and input object types to ensure that only permitted and validated data is processed. Avoid using system commands with user input.

</details>

<details>
    <summary>Hasura</summary>

With Hasura, avoid using raw SQL or system commands that could be injected with user input. Use prepared statements and parameterized queries to handle user input safely.

</details>


### REST Specific

<details>
    <summary>Asp.net</summary>

In ASP.NET, prevent command injection by using parameterized queries or ORM methods instead of concatenating strings to build SQL commands. Always validate and sanitize user inputs.

</details>

<details>
    <summary>Ruby on rails</summary>

In Ruby on Rails, use Active Record methods for database interactions to avoid SQL injection. Validate and sanitize user inputs before using them in system commands.

</details>

<details>
    <summary>Next.js</summary>

In Next.js, avoid using exec or spawn with user inputs for system commands. Use parameterized APIs and validate all inputs to prevent command injection.

</details>

<details>
    <summary>Laravel</summary>

In Laravel, use Eloquent ORM or the query builder with parameter binding to prevent SQL injection. Do not pass user input directly to system commands.

</details>

<details>
    <summary>Express.js</summary>

In Express.js, use middleware like helmet to protect against common vulnerabilities. Validate and sanitize user inputs before using them in system commands.

</details>

<details>
    <summary>Django</summary>

In Django, use the ORM to interact with the database and avoid raw SQL queries. Validate and sanitize user inputs before using them in system commands.

</details>

<details>
    <summary>Symfony</summary>

In Symfony, use Doctrine's parameterized queries to prevent SQL injection. Always validate and sanitize user inputs before using them in system commands.

</details>

<details>
    <summary>Spring boot</summary>

In Spring Boot, use JPA repositories or JDBC templates with named parameters to prevent SQL injection. Validate and sanitize user inputs before using them in system commands.

</details>

<details>
    <summary>Flask</summary>

In Flask, use SQLAlchemy ORM or raw SQL with placeholders to prevent SQL injection. Validate and sanitize user inputs before using them in system commands.

</details>

<details>
    <summary>Nuxt</summary>

In Nuxt.js, avoid using user inputs directly in system commands. Use context-bound parameters and validate all inputs to prevent command injection.

</details>

## Configuration

> Identifier: `injection/command`

### Options

- **skip_objects** : List of objects that are to be skipped by the security test.




### Examples



#### Ignore this check

```json
{
    "checks": {
        "injection/command": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="high-severity">HIGH</span>**

### Compliance

- OWASP: **[API10:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xaa-unsafe-consumption-of-apis.md)**
- pci: **6.5.1**
- gdpr: **Article-32**
- soc2: **CC6.1**
- psd2: **Article-95**
- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **AC-6**

### Classification






### Score

- CVSS_VECTOR: **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:F/RC:R**
- CVSS_SCORE: **8.5**

## References

- [https://owasp.org/www-community/attacks/Command_Injection](https://owasp.org/www-community/attacks/Command_Injection)
  