---
title: Character limit
---

# Character limit

## Description

Clients using GraphQL may craft a query with a huge amount of characters.
This could lead to potential *DoS attacks* or *information leakage*.


## Remediation

Reject requests containing more than a certain number of characters.
For instance, `15000` is a coherent threshold for characters.

This na√Øve approach will not prevent clever hackers from crafting costly requests if short field names are available.
One should prefer the better but more difficult to implement "query complexity" method and set a complexity threshold instead.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

Reject requests containing more than a certain number of characters. For instance, `15000` is a coherent threshold for characters.Install our open source package [GraphQL Armor](https://github.com/Escape-Technologies/graphql-armor) for Apollo.

</details>

<details>
    <summary>Yoga</summary>

Reject requests containing more than a certain number of characters. For instance, `15000` is a coherent threshold for characters.Install our open source package [GraphQL Armor](https://github.com/Escape-Technologies/graphql-armor) for Yoga.Otherwise, you can use the standalone [envelop plugin](https://www.npmjs.com/package/@escape.tech/graphql-armor-character-limit) directly.

</details>

<details>
    <summary>Awsappsync</summary>

Add ACL rule to prevent requests bigger than a threshold. (e.g., 3000 characters)This would be entered into the Rule JSON editor when creating a web ACL in the AWS WAF Console.

</details>

<details>
    <summary>Graphqlgo</summary>

You can limit query size with a net/http middleware in Go.

</details>

<details>
    <summary>Graphqlruby</summary>

In Ruby on Rails, you can create a middleware to reject oversized requests for GraphQL endpoints.

</details>

<details>
    <summary>Hasura</summary>

To prevent oversized requests in Hasura, you can set up a custom limit for the maximum size of a request body.

</details>

## Configuration

> Identifier: `resource_limitation/character_limit`

### Options

- **threshold** : Maximum characters before raising an alert (-1 = infinite)




### Examples



#### Ignore this check

```json
{
    "checks": {
        "resource_limitation/character_limit": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="low-severity">LOW</span>**

### Compliance

- OWASP: **[API8:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md)**
- pci: **6.5.8**
- gdpr: **Article-32**
- soc2: **CC6.1**
- psd2: **Article-95**
- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **AC-4**

### Classification






### Score

- CVSS_VECTOR: **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:H/RL:O/RC:R**
- CVSS_SCORE: **4.9**

## References

- [https://shopify.engineering/rate-limiting-graphql-apis-calculating-query-complexity](https://shopify.engineering/rate-limiting-graphql-apis-calculating-query-complexity)
  