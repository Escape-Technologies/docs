---
title: Directive overloading
---

# Directive overloading

## Description

Directive Overloading occurs when a user can send a query with many consecutive directives and overload the engine handling those directives.


## Remediation

Limit the number of directives allowed in a query.
This should be handled by the GraphQL engine while parsing the document, otherwise this can lead to a heap overflow.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

Upgrade to GraphQL>=16.0.0 if you are not already up to date. You can also use our [GraphQL Armor](https://escape.tech/graphql-armor/docs/getting-started) middleware to limit the number of directives allowed in a query.

</details>

<details>
    <summary>Yoga</summary>

Upgrade to GraphQL>=16.0.0 if you are not already up to date. You can also use our [GraphQL Armor](https://escape.tech/graphql-armor/docs/getting-started) middleware to limit the number of directives allowed in a query.

</details>

<details>
    <summary>Awsappsync</summary>

Implement custom directive limits within AWS AppSync resolvers to prevent overloading. Use AWS WAF to set up rate-based rules for your GraphQL API.

</details>

<details>
    <summary>Graphqlgo</summary>

Ensure you're using the latest version of the GraphQL Go library. Implement a custom directive limit check in your GraphQL server setup.

</details>

<details>
    <summary>Graphqlruby</summary>

Update to the latest version of GraphQL-Ruby. Use the max_depth and max_complexity query analyzers to limit directive usage.

</details>

<details>
    <summary>Hasura</summary>

Configure Hasura's depth limit and complexity analysis to prevent directive overloading. Keep Hasura GraphQL Engine updated to the latest version.

</details>

## Configuration

> Identifier: `resource_limitation/graphql_directive_overload`

### Options

- **threshold** : Maximum number of directives allowed before raising an alert in the fast check.




### Examples



#### Ignore this check

```json
{
    "checks": {
        "resource_limitation/graphql_directive_overload": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="medium-severity">MEDIUM</span>**

### Compliance

- OWASP: **[API8:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md)**
- pci: **6.5.1**
- gdpr: **Article-32**
- soc2: **CC6.1**
- psd2: **Article-95**
- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **AC-2**

### Classification






### Score

- CVSS_VECTOR: **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:H/RL:O/RC:R**
- CVSS_SCORE: **6.9**

