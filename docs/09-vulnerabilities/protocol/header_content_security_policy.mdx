---
title: Content Security Policy Header
---

# Content Security Policy Header

## Description

`Content-Security-Policy` header is missing or set to an insecure value.

## Remediation

Set `Content-Security-Policy` header to a secure value.


### GraphQL Specific

<details>
    <summary>Apollo</summary>

When using Apollo with Express.js, [helmet](https://www.npmjs.com/package/helmet) can take care of the security headers.

</details>

<details>
    <summary>Yoga</summary>

For GraphQL Yoga, you can use middleware to set the Content-Security-Policy header. Here's an example using Express middleware:

</details>

<details>
    <summary>Awsappsync</summary>

Add security headers with the API Gateway. Put your AppSync API behind an API Gateway and configure it to act as a proxy to your AppSync endpoint (e.g., using the HTTP Proxy feature). Then you can manually add headers to each resource.

</details>

<details>
    <summary>Graphqlgo</summary>

You can use a HTTP middleware to add security headers. For instance, with [srikrsna/security-headers](https://github.com/srikrsna/security-headers):

</details>

<details>
    <summary>Graphqlruby</summary>

In Ruby on Rails with GraphQL-Ruby, you can set the Content-Security-Policy header in the controller response. For example:

</details>

<details>
    <summary>Hasura</summary>

With Hasura, you can configure the Content-Security-Policy header using environment variables or directly in the reverse proxy (like Nginx) sitting in front of Hasura.

</details>


### REST Specific

<details>
    <summary>Asp.net</summary>

In ASP.NET, use the `customHeaders` setting in the `web.config` file to set the Content-Security-Policy header.

</details>

<details>
    <summary>Ruby on rails</summary>

In Ruby on Rails, set the Content-Security-Policy header in the application controller or use the `secure_headers` gem.

</details>

<details>
    <summary>Next.js</summary>

For Next.js, set the Content-Security-Policy header in the `next.config.js` file or use a custom server with Express middleware.

</details>

<details>
    <summary>Laravel</summary>

In Laravel, use middleware to set the Content-Security-Policy header.

</details>

<details>
    <summary>Express.js</summary>

In Express.js, use the `helmet` middleware to set the Content-Security-Policy header.

</details>

<details>
    <summary>Django</summary>

In Django, use the `SecurityMiddleware` to set the Content-Security-Policy header.

</details>

<details>
    <summary>Symfony</summary>

In Symfony, configure the Content-Security-Policy header in the `security.yaml` file or use an event listener.

</details>

<details>
    <summary>Spring boot</summary>

In Spring Boot, configure the Content-Security-Policy header in the `SecurityConfig` class.

</details>

<details>
    <summary>Flask</summary>

In Flask, use the `flask-talisman` extension to set the Content-Security-Policy header.

</details>

<details>
    <summary>Nuxt</summary>

In Nuxt.js, set the Content-Security-Policy header using the `@nuxtjs/helmet` module or in the `nuxt.config.js` file.

</details>

## Configuration

> Identifier: `protocol/header_content_security_policy`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "protocol/header_content_security_policy": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="low-severity">LOW</span>**

### Compliance

- OWASP: **[API7:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa7-server-side-request-forgery.md)**
- pci: **6.5.10**
- gdpr: **Article-32**


- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **AC-14**

### Classification






### Score




## References

- [https://owasp.org/www-community/Security_Headers](https://owasp.org/www-community/Security_Headers)
  - [https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching)
  - [https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html)
  