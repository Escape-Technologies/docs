---
title: Cache Control Header
---

# Cache Control Header

## Description

The HTTP 'Cache-Control' header is used to specify directives for caching mechanisms.
The server did not return (or returned an invalid) 'Cache-Control' header, which means pages containing sensitive information could be stored client-side and then be exposed to unauthorized persons.


## Remediation

Whenever possible, ensure the `Cache-Control` HTTP header is set with `no-cache`, `no-store`, `must-revalidate`, and that the pragma HTTP header is set with `no-cache`.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

Implement proper Cache-Control headers for sensitive information to ensure that private data is not stored in the browser cache. Set the 'Cache-Control' header to 'no-store' for responses containing sensitive data to prevent it from being cached on the client-side.

</details>

<details>
    <summary>Yoga</summary>

Implement proper cache control headers to ensure sensitive information is not stored in the cache of a user's browser. Set the 'Cache-Control' header to 'no-store' for responses containing sensitive data related to 'Yoga With' sessions to prevent unauthorized access.

</details>

<details>
    <summary>Awsappsync</summary>

Configure the 'Cache-Control' header in AWS AppSync responses to define appropriate cacheability, set maximum age, and leverage validation tokens.

</details>

<details>
    <summary>Graphqlgo</summary>

Implement proper cache control headers for GraphQL responses to prevent sensitive information from being stored in cache. Set 'Cache-Control' to 'no-store' to ensure that responses are not cached on the client side.

</details>

<details>
    <summary>Graphqlruby</summary>

Implement proper cache control headers for GraphQL responses to prevent sensitive data leakage and ensure that the data is not unnecessarily stored or cached by intermediaries. In Ruby on Rails, you can set the `Cache-Control` header in your GraphQL controller actions using `response.headers['Cache-Control'] = 'no-store'` to instruct clients and proxies not to cache the response.

</details>

<details>
    <summary>Hasura</summary>

Configure the 'Cache-Control' header in the Hasura server responses to specify the appropriate caching policy. For example, set 'Cache-Control: no-store' to prevent sensitive data from being stored in the cache or Cache-Control: max-age=(seconds) to define the maximum amount of time a resource is considered fresh.

</details>


### REST Specific

<details>
    <summary>Asp_net</summary>

In ASP.NET, ensure that sensitive pages send appropriate 'Cache-Control' headers to prevent client-side caching. Use the 'HttpResponse.Cache' property to set the 'Cache-Control' header, for example: 'Response.Cache.SetCacheability(HttpCacheability.NoCache);' to specify that a response should not be cached.

</details>

<details>
    <summary>Ruby_on_rails</summary>

In Ruby on Rails, ensure that the 'Cache-Control' header is set correctly in your responses, particularly for sensitive information. Use 'expires_now' to set 'Cache-Control' to 'no-cache, no-store', or manually set the header using 'response.headers['Cache-Control'] = 'no-cache, no-store, must-revalidate'. This prevents the caching of sensitive pages on the client side.

</details>

<details>
    <summary>Next_js</summary>

In Next.js applications, ensure that your server-side code sets appropriate 'Cache-Control' headers for responses containing sensitive information. Use the 'res.setHeader()' function to set the 'Cache-Control' header to 'no-store' or 'no-cache, private' to prevent sensitive data from being stored in the browser cache. For example, in your API routes or getServerSideProps function, you can include 'res.setHeader('Cache-Control', 'no-store')' before sending the response.

</details>

<details>
    <summary>Laravel</summary>

In Laravel, ensure that your responses containing sensitive information have appropriate 'Cache-Control' headers set. You can use the 'header' method on the response object to set the 'Cache-Control' directive to 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0' to prevent caching. For example: `return response($content)->header('Cache-Control', 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0');` This will instruct the browser and proxies not to cache the sensitive response.

</details>

<details>
    <summary>Express_js</summary>

In Express.js, ensure that responses containing sensitive information have appropriate Cache-Control headers set. Use the 'res.set' function to set the header to 'no-store' to prevent caching of such responses. For example, use 'res.set('Cache-Control', 'no-store, max-age=0')' before sending the response.

</details>

<details>
    <summary>Django</summary>

In Django, ensure that your views that return sensitive information set the 'Cache-Control' header to 'no-store' to prevent the browser from caching the response. You can do this by using the 'cache_control' decorator or by manually setting the header in the response object. For example, use '@cache_control(no_store=True)' on your view functions or 'response['Cache-Control'] = 'no-store'' for HttpResponse objects.

</details>

<details>
    <summary>Symfony</summary>

In Symfony, ensure that responses containing sensitive information have appropriate 'Cache-Control' headers set. Use the 'Response' object to add the header, for example: `$response->headers->set('Cache-Control', 'no-store, no-cache, must-revalidate, post-check=0, pre-check=0');`. This will instruct browsers and proxies not to cache the response.

</details>

<details>
    <summary>Spring_boot</summary>

In Spring Boot, ensure that responses containing sensitive information have appropriate 'Cache-Control' headers set. This can be achieved by configuring the 'CacheControl' in the response headers to 'no-store' or 'no-cache, no-store, must-revalidate' for such responses. You can do this programmatically within your controller methods or globally by implementing a WebMvcConfigurer and overriding the 'addInterceptors' method to add an interceptor that sets the header for each response.

</details>

<details>
    <summary>Flask</summary>

In Flask, ensure that responses containing sensitive information have the 'Cache-Control' header set with appropriate directives, such as 'no-store' to prevent caching. Use 'flask.make_response()' to create a response object and set the header using 'response.headers['Cache-Control'] = 'no-store, no-cache, must-revalidate, max-age=0'. Apply this to all routes that serve sensitive data.

</details>

## Configuration

> Identifier: `protocol/header_cache_control`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "protocol/header_cache_control": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="low-severity">LOW</span>**

### Compliance

- OWASP: **[API7:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa7-server-side-request-forgery.md)**
- pci: **6.5.10**
- gdpr: **Article-32**
- soc2: **CC6.1**
- psd2: **Article-95**
- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **SC-28**

### Classification






### Score




## References

- [https://owasp.org/www-community/Security_Headers](https://owasp.org/www-community/Security_Headers)
  - [https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching)
  - [https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html)
  