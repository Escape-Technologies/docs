---
title: Detect
---

# Detection

The detect section is where you specify the criteria to detect the success or failure of the security test, and whether or not to alert.

You can simply test on the response status code, or you can test on the response body, response time, or JSON response.

In the same format using key and operator, you can select the data you want to test from the response body and test it.

## Available keys

With all the aforementioned matchers, you can match on the following keys :

- [scan.type](#scantype)
- [schema.operation](#schemaoperation)
- [schema.need_authentication](#schemaneed_authentication)
- [schema.url](#schemaurl)
- [schema.method](#schemamethod)
- [request.is_authenticated](#requestis_authenticated)
- [request.user](#requestuser)
- [request.headers](#requestheaders)
- [request.body](#requestbody)
- [helpers.request.scalars](#helpersrequestscalars)
- [helpers.request.crud](#helpersrequestcrud)
- [response.status_code](#responsestatus_code)
- [response.duration_ms](#responseduration_ms)
- [response.headers](#responseheaders)
- [response.body](#responsebody)
- [helpers.response.scalars](#helpersresponsescalars)
- [helpers.response.is_successful](#helpersresponseis_successful)

### scan.type

> type: [`enum`](#enum-matcher)

Example :

```yaml
detection:
  - key: scan.type
    is: "REST"
```

### schema.operation

> type: `aaa`

### schema.need_authentication

> type: [`bool`](#enum-matcher)

### schema.url

> type: `aaa`

### schema.method

> type: `aaa`

### request.is_authenticated

> type: `aaa`

### request.user

> type: `aaa`

### request.headers

> type: `aaa`

### request.body

> type: `aaa`

### helpers.request.scalars

> type: `aaa`

### helpers.request.crud

> type: `aaa`

### response.status_code

> type: `aaa`

### response.duration_ms

> type: `aaa`

### response.headers

> type: `aaa`

### response.body

> type: `aaa`

### helpers.response.scalars

> type: `aaa`

### helpers.response.is_successful

> type: `aaa`

## Matchers

There are various types of matchers available:

- [Boolean](#boolean-matcher)
- [String](#string-matcher)
- [Integer](#integer-matcher)
- [Enum](#enum-matcher)
- [Dictionary](#dictionary-matcher)
- [JSON](#json-matcher)
- [Scalar](#scalar-matcher)

### Boolean matcher

You can match over a boolean with the simple `is` matcher.

Example :

```yaml
detection:
  - key: helpers.response.is_successful
    is: true
```

### String matcher

You can match over a string in a lot of different ways :

- `is` : The string is exactly the same
- `in` : The string is in the given list
- `contains` : The string contains the given value
- `regex` : The string full match the given regex with ignore case flag (you can try your regex [here](https://regex101.com/))

Example :

```yaml
detection:
  - key: schema.url
    contains: "admin"
```

### Integer matcher

You can match over a integer in a lot of different ways :

- `is` : The integer is exactly the same
- `in` : The integer is in the given list
- `gt` : The integer is greater than the given value (or equal)
- `lt` : The integer is lower than the given value (or equal)

You can combine `gt` and `lt` to create a range.

Example :

```yaml
detection:
  - key: response.status_code
    gt: 200
    lt: 299
```

### Enum matcher

Some keys contain a single value that is defined in an Enum.

Example : 

```yaml
detection:
  - key: helpers.request.crud # (= "CREATE")
    in:
      - "CREATE"
      - "READ"
```

### Dictionary matcher

For data that is structured as a dictionary of key-values and you want to match on both the key and value.

Example:

```yaml
detection:
  - key: request.header
    key:
      # string matcher
      is: "Content-Type"
    value:
      # string matcher
      regex: "application/.*"
```

### JSON matcher

You can match over a JSON in a lot of different ways :

- `is` : The JSON is exactly the same as the given JSON
- `in` : The JSON is in the given list of JSON
- `key` : The given key is present in the JSON
- `jq` : The string match the given [jq](https://stedolan.github.io/jq/) filter

### Scalar matcher

Escape explore your API using scalars : each key of the query and the response will be extracted and stored as a scalar.
It can be helpful to understand what is the underlying type of a key in a from.

For example you may have a `user_id` key typed as string in your json schema, but in the underlying database store it as an UUID,
escape will tag this key as `ID` and `UUID`, and during the scan, this scalars will be refined to `UUID` only.

You so can match the scalar type using an enum matcher with our predefined scalars :

```yaml
detection:
  - key: helpers.response.scalars
    type:
      in:
        - "IPV4"
        - "IPV6"
```

You can also match a scalar by it's name using a string matcher :

```yaml
detection:
  - key: helpers.response.scalars
    name:
      # string matcher
      regex: ".*@escape.tech"
```
You can also match a scalar by value using a string matcher :

```yaml
detection:
  - key: helpers.response.scalars
    value:
      # string matcher
      regex: ".*@escape.tech"
```

You can also match on the sensitivity of a scalar using an enum matcher:

```yaml
detection:
  - key: helpers.response.scalars
    sensitivity:
      in:
        - "HIGH"
        - "MEDIUM"
```
