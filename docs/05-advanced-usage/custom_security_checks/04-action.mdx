---
title: Action
---

# Action

Once you have filtered the exploration results, you can apply actions to them.

Actions are a set of operations that will be applied to the request before sending it to the target.

You can leverage the powerful features of Escape's technology to fuzz in a technology-agnostic manner, but with full knowledge of the data types underneath (aka scalar).

Keep in mind that the Raw HTTP requests are not modified by actions, but you can use the `detection` after the action to filter the results (like v1 custom security checks).

---

## Available keys

You can simply use the `action` action to set a key in the request.

- [request.body](#requestbody)
- [request.headers](#requestheaders)
- [request.cookies](#requestcookies)
- [helpers.request.arguments](#helpersrequestarguments)
- [helpers.request.scalars](#helpersrequestscalars)

### request.body

> type: [`string`](#string-action) / [`JSON`](#json-action)

Example :
```yaml
action:
  - action: request.body
    jq: '. | {"user": .user + " {{modify_value}}"}'
  - action: request.body
    
```


### request.headers

> type: [`dict`](#dictionary-action)

Example :
```yaml

```


### request.cookies

> type: [`dict`](#dictionary-action)

Example :
```yaml
action:
  - action: request.cookies
    key: "SESSIONID"
    value: "{{modify_value}}"
```


### helpers.request.arguments

The helper for request arguments is an agnostic abstraction from Escape, that helps you abstract the underlying protocol/technology.

These arguments can be found in the URL, in the body, in the headers, in the cookies, in the path itself, in the query etc.

> type: [`dict`](#dictionary-action)

Example :
```yaml
action:
  - action: helpers.request.arguments
    selector: arg_name
    location: query # in the url query like example.com/?arg_name=arg_value
    value: "{{modify_value}}"
```


### helpers.request.scalars

> type: [`string`](#scalar-action)

Example :
```yaml
action:
  - action: helpers.request.scalars
    select: # first we select the scalar with multiple criteria
      kind:
        in:
        - "EMAIL"
        - "PASSWORD"
      name:
        regex: ".*@escape.tech"
      sensitivity:
        in:
        - "HIGH"
        - "MEDIUM"
      value:
        is_not: "admin@escape.tech"
    mutate: # then we mutate the scalar
      value: "{{modify_value}}"
      # or
      values:
        - "{{modify_value}}"
        - "{{modify_value2}}"
      # or
      regex_replace:
        regex: "(.*)@escape.tech"
        replace: "$1@attacker.com"
      # or
      auto_mutate: true # use auto-generated payloads depending on the scalar type
```

---

## Actions

Depending on the type of the action, you can use different actions.

### String action
Example :

```yaml
action:
  - action: request.body
    regex_replace: # consider the body as a string and regex replace
      regex: "(.*)@escape.tech"
      replace: "$1@attacker.com"
```


### Dictionary action

A dictionary action is a set of key/value pairs that will be added or modified in the request.
If you'd like to remove a key, you can use the `remove` key.

Example :

```yaml
action:
  - action: request.headers
    key: "X-Forwarded-.*"
    value: "{{modify_value}}"
  - action: request.cookies
    key: "SESSIONID"
    value: "{{modify_value}}"
  - action: request.cookies
    key: "unauthenticated"
    remove: true
```


### JSON action
Example :

```yaml
action:
  - action: request.body
    jq: '. | {"user": .user + " {{modify_value}}"}'
```


### Enum action
Example :

```yaml
action:
  - action:
```


### Scalar action
Example :

```yaml
action:
  - action: helpers.request.scalars
    select: # first we select the scalar with multiple criteria
      kind:
        in:
        - "EMAIL"
        - "PASSWORD"
      name:
        regex: ".*@escape.tech"
      sensitivity:
        in:
        - "HIGH"
        - "MEDIUM"
      value:
        is_not: "admin@escape.tech"
    mutate: # then we mutate the scalar
      value: "{{modify_value}}"
      # or
      values:
        - "{{modify_value}}"
        - "{{modify_value2}}"
      # or
      regex_replace:
        regex: "(.*)@escape.tech"
        replace: "$1@attacker.com"
      # or
      auto_mutate: true # use auto-generated payloads depending on the scalar type
```


## Example

<details>
```yaml
    detection:
      - detect: helpers.response.scalars
        name:
          # string matcher
          regex: ".*@escape.tech"

    action:
      - action: helpers.response.scalars.remove
        name:
          # string matcher
          regex: ".*@escape.tech"

      - action: request.headers
        key: "X-Forwarded-.*"
        value: "{{modify_value}}"

      - action: request.headers
        key: "X-Forwarded-For"
        value: "{{modify_value}}"

      - action: request.headers
        key: "X-Forwarded-For"
        regex_replace:
          regex: "{{regex}}"
          value: "$1{{modified_value}}"

      - action: request.headers
        key: "X-.*"
        remove: true

      - action: request.headers
        key: "X-Forwarded-For"
        value: "{{modify_value}}"
        add: true

      - action: request.body
        jq: '. | {"user": .user + " {{modify_value}}"}'

      - action: helpers.request.scalars
        select: # first we select the scalar with multiple criteria
          kind:
            in:
            - "EMAIL"
            - "PASSWORD"
          name:
            regex: ".*@escape.tech"
          sensitivity:
            in:
            - "HIGH"
            - "MEDIUM"
          value:
            is_not: "admin@escape.tech"
        mutate: # then we mutate the scalar
          value: "{{modify_value}}"
          # or
          values:
            - "{{modify_value}}"
            - "{{modify_value2}}"
          # or
          regex_replace:
            regex: "(.*)@escape.tech"
            replace: "$1@attacker.com"
          # or
          auto_mutate: true # use auto-generated payloads depending on the scalar type

      - action: request.body
        select:
          key: "user"

      - action: request.body
        key:
          # string matcher
          is: "Content-Type"
        value:
          # string matcher
          regex: "application/.*"


      - action: request.headers
        selector: Content-Type
        value: "{{modify_value}}"

      - action: helpers.request.scalars
        scalar: "EMAIL"
        value: "{{modify_value}}"

      - action: helpers.request.scalars
        scalar: "URL"
        auto_payloads: true

      - action: request.body
        jq: '. | {"user": .user + " {{modify_value}}"}'

      - action: helpers.request.arguments
        selector: arg_name
        value: "{{modify_value}}"
```
</details>