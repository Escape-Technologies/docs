---
title: Public state-altering operation
---

# Public state-altering operation

## Description

Any route that mutates application data should not be public.
Generally, REST `READ`, `UPDATE`, `DELETE` requests and GraphQL mutations should be protected by an authentication middleware.


## Remediation

Restrict access to the route, using an authentication middleware for example.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

Ensure that all mutations in Apollo Server are protected by authentication. Use context to share authentication state and apply checks before resolving operations.

</details>

<details>
    <summary>Yoga</summary>

In GraphQL Yoga, use middleware to verify authentication before processing mutations. Apply authentication checks within the context or resolver middleware.

</details>

<details>
    <summary>Awsappsync</summary>

For AWS AppSync, configure resolvers to use AWS_IAM or Amazon Cognito for securing your GraphQL endpoints. Attach appropriate policies to IAM roles or use Cognito User Pools.

</details>

<details>
    <summary>Graphqlgo</summary>

In GraphQL-Go, protect your mutations by implementing authentication logic within the resolver functions. Use context to pass authenticated user information.

</details>

<details>
    <summary>Graphqlruby</summary>

In GraphQL-Ruby, use before_action in your controller to protect your GraphQL mutations or implement authorization logic within your mutation resolvers.

</details>

<details>
    <summary>Hasura</summary>

With Hasura, use webhook or JWT authentication modes to secure your GraphQL mutations. Configure permissions appropriately in Hasura Console.

</details>


### REST Specific

<details>
    <summary>Asp.net</summary>

In ASP.NET, use the [Authorize] attribute to protect your mutating endpoints. Apply this attribute to controllers or actions that should be secured.

</details>

<details>
    <summary>Ruby on rails</summary>

In Ruby on Rails, use before_action in your controller to require authentication for mutating actions. Utilize current_user to check for authenticated users.

</details>

<details>
    <summary>Next.js</summary>

In Next.js API routes, implement server-side authentication checks before processing POST, PUT, or DELETE requests.

</details>

<details>
    <summary>Laravel</summary>

In Laravel, use middleware to protect routes that mutate data. Apply the 'auth' middleware to routes or route groups.

</details>

<details>
    <summary>Express.js</summary>

In Express.js, use middleware functions to authenticate requests before processing POST, PUT, or DELETE routes.

</details>

<details>
    <summary>Django</summary>

In Django, use the @login_required decorator or a custom decorator to protect views that perform state changes.

</details>

<details>
    <summary>Symfony</summary>

In Symfony, secure your controllers with access control rules in security.yaml or use annotations to require authentication for certain routes.

</details>

<details>
    <summary>Spring boot</summary>

In Spring Boot, secure your endpoints using Spring Security. Configure HttpSecurity to require authentication for mutating HTTP methods.

</details>

<details>
    <summary>Flask</summary>

In Flask, use the @login_required decorator from Flask-Login or a custom decorator to protect your mutating routes.

</details>

<details>
    <summary>Nuxt</summary>

In Nuxt.js, use middleware to check for authentication on server-side routes or API calls that mutate data.

</details>

## Configuration

> Identifier: `access_control/public_mutation_endpoint`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "access_control/public_mutation_endpoint": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="medium-severity">MEDIUM</span>**
  - OWASP: **[API5:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa5-broken-function-level-authorization.md)**
  - PCI DSS: **6.5.8**
  - CWE
    - **200**
    - **264**
    - **275**
    - **284**
    - **285**
  - WASC: **WASC-02**
  
  






## References

- [https://owasp.org/Top10/A01_2021-Broken_Access_Control/](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)
  