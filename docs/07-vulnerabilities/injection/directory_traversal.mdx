---
title: Directory traversal
---

# Directory traversal

## Description

Directory traversal occurs when a server allows an attacker to read a file or directories outside of the normal web server directory, and local file inclusion gives the attacker the ability to include an arbitrary local file (from the web server) in the web server's response.


## Remediation

There are multiple ways to prevent directory traversal attacks:
- Avoid using parameters entered directly by the user.
- Set up a file/folder name whitelist system: allow only certain folders and/or types of extensions, thus excluding all others.
- Compartmentalize your data and implement middlewares. These can take the form of an interface to the (potentially external) file system on which the data users may request is stored. If the attached data storage is dedicated to this purpose only and does not contain sensitive data, the risk is limited, even if a user manages to bypass the limitations that this middleware can put in place.
- Restrict access of the GraphQL worker to what is strictly necessary. By restricting as much as possible the files and folders to which the GraphQL worker has access, you reduce the range of files potentially exposed by an attack.
- Take advantage of virtualization. With virtualization, it is possible to have several virtual machines completely isolated from each other. The GraphQL worker can therefore be isolated on its own virtual machine, allowing it access only to the elements absolutely necessary for its proper execution.



### REST Specific

<details>
    <summary>Asp.net</summary>

In ASP.NET, prevent directory traversal by validating user input, using built-in functions to create file paths, and employing proper exception handling.

</details>

<details>
    <summary>Ruby on rails</summary>

In Ruby on Rails, use whitelisting to ensure only allowed paths can be accessed and sanitize user input to prevent directory traversal.

</details>

<details>
    <summary>Next.js</summary>

In Next.js, avoid using user input directly in file paths, and use a whitelist approach to serve files. Validate and sanitize all user input.

</details>

<details>
    <summary>Laravel</summary>

In Laravel, use the built-in functions to handle file operations and validate all user inputs to prevent directory traversal attacks.

</details>

<details>
    <summary>Express.js</summary>

In Express.js, validate and sanitize user input before using it in file system operations. Use path.join() and path.normalize() to create safe paths.

</details>

<details>
    <summary>Django</summary>

In Django, use the built-in serving mechanisms and avoid directly exposing the file system to user input to prevent directory traversal.

</details>

<details>
    <summary>Symfony</summary>

In Symfony, use the Filesystem component to safely handle files and validate user input to prevent directory traversal vulnerabilities.

</details>

<details>
    <summary>Spring boot</summary>

In Spring Boot, sanitize and validate user input before using it in file operations. Use built-in methods to construct file paths safely.

</details>

<details>
    <summary>Flask</summary>

In Flask, ensure that user input is validated and sanitized before using it to access the file system to prevent directory traversal.

</details>

<details>
    <summary>Nuxt</summary>

In Nuxt, avoid using user input directly in file paths, and use a whitelist approach to serve files. Validate and sanitize all user input.

</details>

## Configuration

> Identifier: `injection/directory_traversal`

### Options

- **skip_objects** : List of object that are to be skipped by the security test.
  



### Examples



#### Ignore this check

```json
{
    "checks": {
        "injection/directory_traversal": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="high-severity">HIGH</span>**
  - OWASP: **[API10:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xaa-unsafe-consumption-of-apis.md)**
  - PCI DSS: **6.5.8**
  - CWE
    - **22**
    - **23**
    - **24**
    - **25**
    - **26**
    - **27**
    - **28**
    - **29**
    - **30**
    - **31**
    - **32**
    - **33**
    - **34**
    - **35**
    - **36**
    - **37**
    - **38**
    - **39**
    - **40**
  - WASC: **WASC-33**
  
  






## References

- [https://escape.tech/blog/file-inclusion-directory-traversal-graphql/](https://escape.tech/blog/file-inclusion-directory-traversal-graphql/)
  