---
title: SSTI (Server-Side Template Injection)
---

# SSTI (Server-Side Template Injection)

## Description

Server-Side Template Injection occurs when an attacker can inject arbitrary content into a template, which is then executed and rendered on the server. This can lead to a variety of attacks, such as remote code execution, information disclosure, and more.
It's especially dangerous in environments where the template engine has functionalities that allow shell command execution or other powerful capabilities.


## Remediation

To prevent SSTI:

1. Always validate and sanitize user input rigorously.
2. If possible, avoid passing user input directly to template engines.
3. Make sure to use the latest versions of template engines which might have patches for known vulnerabilities.
4. Restrict template engine's capabilities if possible, so that even if an injection occurs, the impact can be minimized.



### REST Specific

<details>
    <summary>Asp.net</summary>

In ASP.NET, ensure that user input is not directly used in template generation. Use rigorous input validation and encoding to prevent SSTI. Additionally, restrict the template engine features that can be used if possible.

</details>

<details>
    <summary>Ruby on rails</summary>

For Ruby on Rails, avoid directly passing user input to the rendering engine. Validate and sanitize input rigorously. Use the 'html_escape' or 'sanitize' helpers to encode user input.

</details>

<details>
    <summary>Next.js</summary>

In Next.js, prevent SSTI by avoiding the use of user input in template literals or JSX without proper sanitization. Use a secure library for handling user input.

</details>

<details>
    <summary>Laravel</summary>

In Laravel, use the built-in escaping functions like '{{ }}' in Blade templates to automatically escape output and prevent SSTI. Do not use '{!! !!}' with untrusted data as it does not escape output.

</details>

<details>
    <summary>Express.js</summary>

For Express.js applications, ensure that user input is not embedded directly into templates. Use template engines that automatically escape values, or manually escape input using a library.

</details>

<details>
    <summary>Django</summary>

In Django, use the built-in template system which auto-escapes variables. Avoid using the 'safe' filter or 'mark_safe' function with untrusted data to prevent SSTI.

</details>

<details>
    <summary>Symfony</summary>

For Symfony, utilize Twig's auto-escaping feature to prevent SSTI. Always validate and sanitize user input before rendering it in a template.

</details>

<details>
    <summary>Spring boot</summary>

In Spring Boot, use Thymeleaf or another template engine that automatically escapes user input. Avoid using SpEL expressions with untrusted data to prevent SSTI.

</details>

<details>
    <summary>Flask</summary>

With Flask, use Jinja2's autoescape feature to prevent SSTI. Ensure that you do not disable autoescaping and validate all user input before rendering.

</details>

<details>
    <summary>Nuxt</summary>

In Nuxt, avoid directly using user input in templates. Use Vue's v-bind or mustache syntax which automatically escapes values to prevent SSTI.

</details>

## Configuration

> Identifier: `injection/ssti`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "injection/ssti": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="high-severity">HIGH</span>**

### Compliance

- OWASP: **[API10:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xaa-unsafe-consumption-of-apis.md)**
- pci: **6.5.1**
- gdpr: **Article-32**
- soc2: **CC6.1**

- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **AC-6**

### Classification






### Score

- CVSS_VECTOR: **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:F/RL:O/RC:C**
- CVSS_SCORE: **6.8**

## References

- [https://portswigger.net/web-security/server-side-template-injection](https://portswigger.net/web-security/server-side-template-injection)
  