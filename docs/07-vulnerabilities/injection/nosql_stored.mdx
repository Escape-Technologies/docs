---
title: NoSQL Injection Stored
---

# NoSQL Injection Stored

## Description

A NoSQL injection vulnerability occurs when users can insert (or “inject”) malicious NoSQL code in a legit SQL query that is built from user-submitted input.
A successful NoSQL injection exploit can read sensitive data from the database, modify database data, execute administration operations on the database (such as shutting down the DBMS), recover the content of a given file from the DBMS file system and in some cases issue commands to the operating system.


## Remediation

Primary defenses:
- Use a sanitization library.
- Cast the inputs to the expected type (eg: The username and password are strings so cast the variables to a string).
- Never use `where`, `mapReduce`, or `group` operators with user input: they allow the attacker to inject JavaScript and are therefore much more dangerous than others. For extra safety, set `javascriptEnabled` to false in mongod.conf (if using mongoDB).
- Enforce Least Privilege.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

To prevent NoSQL injection in Apollo, validate and sanitize all user inputs. Use parameterized queries or the Apollo built-in features to handle user input safely.

</details>

<details>
    <summary>Yoga</summary>

In Yoga, ensure that all inputs are properly validated and sanitized. Avoid directly passing user input to database queries.

</details>

<details>
    <summary>Awsappsync</summary>

For AWS AppSync, use VTL (Velocity Template Language) to sanitize and validate input arguments before they are passed to resolvers.

</details>

<details>
    <summary>Graphqlgo</summary>

In GraphQL-Go, use middleware to validate and sanitize input data before it reaches the resolver functions.

</details>

<details>
    <summary>Graphqlruby</summary>

For GraphQL-Ruby, use built-in validators or custom validation methods to ensure that all inputs are properly sanitized before executing queries.

</details>

<details>
    <summary>Hasura</summary>

With Hasura, leverage permission rules and session variables to control access and validate inputs at the GraphQL layer.

</details>

## Configuration

> Identifier: `injection/nosql_stored`

### Options

- **skip_objects** : List of object that are to be skipped by the security test.
  



### Examples



#### Ignore this check

```json
{
    "checks": {
        "injection/nosql_stored": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="high-severity">HIGH</span>**
  - OWASP: **[API9:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa9-improper-inventory-management.md)**
  - PCI DSS: **6.5.1**
  - CWE
    - **89**
    - **564**
    - **943**
  - WASC: **WASC-19**
  
  






## References

- [https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.6-Testing_for_NoSQL_Injection](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.6-Testing_for_NoSQL_Injection)
  