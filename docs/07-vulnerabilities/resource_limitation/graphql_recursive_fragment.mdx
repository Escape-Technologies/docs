---
title: Recursive Fragment
---

# Recursive Fragment

## Description

This is a DoS vulnerability that allows an attacker with specifically designed queries to cause stack overflow panics. Any user with access to the GraphQL handler can send these queries and cause stack overflows. This in turn could potentially compromise the ability of the server to serve data to its users.


## Remediation

Implement a maximum recursion limit.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

To prevent stack overflow panics in Apollo Server, implement query depth limiting and complexity analysis to reject overly complex queries.

</details>

<details>
    <summary>Yoga</summary>

For GraphQL Yoga, use depth and complexity limiting to mitigate the risk of stack overflow due to recursive queries.

</details>

<details>
    <summary>Awsappsync</summary>

In AWS AppSync, configure query depth limiting and use AWS WAF to block malicious queries that could cause stack overflows.

</details>

<details>
    <summary>Graphqlgo</summary>

For the graphql-go server, implement a query depth limiting middleware to prevent recursive query attacks.

</details>

<details>
    <summary>Graphqlruby</summary>

In GraphQL-Ruby, use the max_depth query analyzer to protect against deep recursive queries causing stack overflows.

</details>

<details>
    <summary>Hasura</summary>

For Hasura GraphQL engine, set up query depth limits in the console under the 'Security' settings to prevent DoS attacks.

</details>

## Configuration

> Identifier: `resource_limitation/graphql_recursive_fragment`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "resource_limitation/graphql_recursive_fragment": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="medium-severity">MEDIUM</span>**
  - OWASP: **[API8:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa8-security-misconfiguration.md)**
  - PCI DSS: **6.5.1**
  - CWE
    - **20**
    - **400**
    - **664**
    - **770**
  
  
  






## References

- [https://github.com/graph-gophers/graphql-go/security/advisories/GHSA-mh3m-8c74-74xh](https://github.com/graph-gophers/graphql-go/security/advisories/GHSA-mh3m-8c74-74xh)
  