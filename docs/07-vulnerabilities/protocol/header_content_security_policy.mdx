---
title: Content Security Policy Header
---

# Content Security Policy Header

## Description

`Content-Security-Policy` header is missing or set to an insecure value.

## Remediation

Set `Content-Security-Policy` header to a secure value.


### GraphQL Specific

<details>
    <summary>Apollo</summary>

When using Apollo with Express.js, [helmet](https://www.npmjs.com/package/helmet) can take care of the security headers.```javascriptconst helmet = require("helmet");...app.use(helmet);```

</details>

<details>
    <summary>Yoga</summary>

For GraphQL Yoga, you can use middleware to set the Content-Security-Policy header. Here's an example using Express middleware:

</details>

<details>
    <summary>Awsappsync</summary>

* Add security headers with the API GatewayPut your AppSync API behind an API Gateway and configure it to act as a proxy to your AppSync endpoint (e.g., using the HTTP Proxy feature).[API Gateway Documentation](https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html) Then you can manually add headers to each resource. (There is only one resource if your API Gateway is only used to proxy a single AppSync endpoint)Here is an example of security headers you can add :```Cache-Control: no-store Content-Security-Policy: default-src 'self'Strict-Transport-Security: max-age=63072000 X-Content-Type-Options: nosniffX-Frame-Options: SAMEORIGINX-XSS-Protection: 1; mode=block```

</details>

<details>
    <summary>Graphqlgo</summary>

You can use a HTTP middleware to add security headers.For instance, with [srikrsna/security-headers](https://github.com/srikrsna/security-headers): ```goimport (  secure "github.com/srikrsna/security-headers") h := handler.New(&handler.Config{  Schema:   &schema,  ...})s := &secure.Secure{  STSIncludeSubdomains: true,  STSPreload:           true,  STSMaxAgeSeconds:     90,  FrameOption: secure.FrameAllowFrom,  FrameOrigin: "https://example.com/",  ContentTypeNoSniff: true,  XSSFilterBlock: true,  HPKPPins: []string{  "HBkhsug765gdKHhvdj6jdb7jJh/j+soZS7sWs=",  "hjshHSHU68hbdkHhvdkgksgsg+jd/jHJ68HBH=",  },  HPKPMaxAge:            5184000,  HPKPReportURI:         "https://www.example.org/hpkp-report",  HPKPIncludeSubdomains: true,  ExpectCTMaxAge:    5184000,  ExpectCTEnforce:   true,  ExpectCTReportUri: "https://www.example.org/ct-report",  ReferrerPolicy: secure.ReferrerStrictOriginWhenCrossOrigin,}http.Handle("/graphql", s.Middleware()(h))http.ListenAndServe(":8082", nil)```

</details>

<details>
    <summary>Graphqlruby</summary>

In Ruby on Rails with GraphQL-Ruby, you can set the Content-Security-Policy header in the controller response. For example:

</details>

<details>
    <summary>Hasura</summary>

With Hasura, you can configure the Content-Security-Policy header using environment variables or directly in the reverse proxy (like Nginx) sitting in front of Hasura. For Nginx:

</details>


## Configuration

> Identifier: `protocol/header_content_security_policy`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "protocol/header_content_security_policy": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="low-severity">LOW</span>**
  - OWASP: **[API7:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa7-server-side-request-forgery.md)**
  - PCI DSS: **6.5.10**
  - CWE
  - WASC: **WASC-15**
  
  






## References

- [https://owasp.org/www-community/Security_Headers](https://owasp.org/www-community/Security_Headers)
  - [https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching)
  - [https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html)
  