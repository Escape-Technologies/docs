---
title: X-Content-Type-Options
---

# X-Content-Type-Options

## Description

The Anti-MIME-Sniffing header `X-Content-Type-Options` is missing or not set to `nosniff`.
This allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the declared content type. Current and legacy versions of Firefox will use the declared content type (if one is set), rather than performing MIME-sniffing.


## Remediation

Ensure that the application/web server sets the `Content-Type` header appropriately and that it sets the `X-Content-Type-Options` header to `nosniff` for all web pages.
If possible, ensure that the end user uses a standards-compliant and modern web browser that does not perform MIME-sniffing at all or that can be directed by the web application/web server to not perform MIME-sniffing.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

When using Apollo with Express.js, [helmet](https://www.npmjs.com/package/helmet) can take care of the security headers.

</details>

<details>
    <summary>Yoga</summary>

For GraphQL Yoga, you can use middleware to set the `X-Content-Type-Options` header to `nosniff`. Here's an example using Express.js middleware:

</details>

<details>
    <summary>Awsappsync</summary>

* Add security headers with the API Gateway
Put your AppSync API behind an API Gateway and configure it to act as a proxy to your AppSync endpoint (e.g., using the HTTP Proxy feature).
[API Gateway Documentation](https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html) Then you can manually add headers to each resource. (There is only one resource if your API Gateway is only used to proxy a single AppSync endpoint)
Here is an example of security headers you can add :
```Cache-Control: no-store
Content-Security-Policy: default-src 'self'
Strict-Transport-Security: max-age=63072000
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block```
* Add security headers using only AWS AppSync
AWS AppSync currently does not allow to append custom headers to every response. However, custom response headers can be configured individually for every resolver by using response mapping templates.
To do this, go to:
  - AppSync > {Your App} > Schema
For every attached resolver :
  - Go to the resolver configuration
  - In the 'Configure the response mapping template' section, add this :
```php
$util.http.addResponseHeader('Cache-Control', 'no-store')
$util.http.addResponseHeader('Content-Security-Policy' , 'default-src 'self'')
$util.http.addResponseHeader('Strict-Transport-Security', 'max-age=63072000')
$util.http.addResponseHeader('X-Content-Type-Options', 'nosniff')
$util.http.addResponseHeader('X-Frame-Options', 'SAMEORIGIN')
$util.http.addResponseHeader('X-XSS-Protection', '1; mode=block') ```

</details>

<details>
    <summary>Graphqlgo</summary>

You can use a HTTP middleware to add security headers.For instance, with [srikrsna/security-headers](https://github.com/srikrsna/security-headers):

</details>

<details>
    <summary>Graphqlruby</summary>

In Ruby on Rails, you can set the `X-Content-Type-Options` header in your GraphQL controller like this:

</details>

<details>
    <summary>Hasura</summary>

For Hasura GraphQL engine, you can configure the `X-Content-Type-Options` header directly in the Hasura console under the `Settings` tab, or by setting the environment variable `HASURA_GRAPHQL_UNAUTHORIZED_ROLE` to include the header.

</details>


### REST Specific

<details>
    <summary>Asp.net</summary>

In ASP.NET, you can set the `X-Content-Type-Options` header globally in the `Startup.cs` file:

</details>

<details>
    <summary>Ruby on rails</summary>

In Ruby on Rails, you can set the `X-Content-Type-Options` header in `config/application.rb` or within a specific controller:

</details>

<details>
    <summary>Next.js</summary>

In Next.js, you can create a custom server using Express.js and set the `X-Content-Type-Options` header:

</details>

<details>
    <summary>Laravel</summary>

In Laravel, you can create a middleware to set the `X-Content-Type-Options` header:

</details>

<details>
    <summary>Express.js</summary>

When using Express.js, you can use the `helmet` middleware to set the `X-Content-Type-Options` header:

</details>

<details>
    <summary>Django</summary>

In Django, you can use the `SecurityMiddleware` to set the `X-Content-Type-Options` header:

</details>

<details>
    <summary>Symfony</summary>

In Symfony, you can set the `X-Content-Type-Options` header in the `security.yaml` configuration file:

</details>

<details>
    <summary>Spring boot</summary>

In Spring Boot, you can set the `X-Content-Type-Options` header using a `WebSecurityConfigurerAdapter`:

</details>

<details>
    <summary>Flask</summary>

In Flask, you can use the `after_request` decorator to set the `X-Content-Type-Options` header:

</details>

<details>
    <summary>Nuxt</summary>

In Nuxt.js, you can set the `X-Content-Type-Options` header using the `render` property in `nuxt.config.js`:

</details>

## Configuration

> Identifier: `protocol/header_x_content_type_options`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "protocol/header_x_content_type_options": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="low-severity">LOW</span>**

### Compliance

- OWASP: **[API7:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa7-server-side-request-forgery.md)**
- pci: **6.5.10**
- gdpr: **Article-32**


- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **AC-4**

### Classification






### Score

- CVSS_VECTOR: **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:H/RL:O/RC:C**
- CVSS_SCORE: **5.1**

