---
title: Cache Control Header
---

# Cache Control Header

## Description

The HTTP 'Cache-Control' header is used to specify directives for caching mechanisms.
The server did not return (or returned an invalid) 'Cache-Control' header, which means pages containing sensitive information could be stored client-side and then be exposed to unauthorized persons.


## Remediation

Whenever possible, ensure the `Cache-Control` HTTP header is set with `no-cache`, `no-store`, `must-revalidate`, and that the pragma HTTP header is set with `no-cache`.



### GraphQL Specific

<details>
    <summary>Apollo</summary>

When using Apollo with Express.js, [helmet](https://www.npmjs.com/package/helmet) can take care of the security headers.

</details>

<details>
    <summary>Awsappsync</summary>

* Add security headers with the API Gateway
Put your AppSync API behind an API Gateway and configure it to act as a proxy to your AppSync endpoint (e.g., using the HTTP Proxy feature).
[API Gateway Documentation](https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html) Then you can manually add headers to each resource. (There is only one resource if your API Gateway is only used to proxy a single AppSync endpoint)
Here is an example of security headers you can add :
```Cache-Control: no-store
Content-Security-Policy: default-src 'self'
Strict-Transport-Security: max-age=63072000
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block```
* Add security headers using only AWS AppSync
AWS AppSync currently does not allow to append custom headers to every response. However, custom response headers can be configured individually for every resolver by using response mapping templates.
To do this, go to:
  - AppSync > {Your App} > Schema
For every attached resolver :
  - Go to the resolver configuration
  - In the "Configure the response mapping template" section, add this :
```php
$util.http.addResponseHeader("Cache-Control", "no-store")
$util.http.addResponseHeader("Content-Security-Policy" , "default-src 'self'")
$util.http.addResponseHeader("Strict-Transport-Security", "max-age=63072000")
$util.http.addResponseHeader("X-Content-Type-Options", "nosniff")
$util.http.addResponseHeader("X-Frame-Options", "SAMEORIGIN")
$util.http.addResponseHeader("X-XSS-Protection", "1; mode=block") ```
You can safely ignore this warning if you did this for every single resolver.
However, it may still appear here as GraphQL requests like `query { __typename }` are not associated with a resolver; therefore, you cannot add custom response headers. (Which doesn't matter as such requests cannot leak data as no actual field is queried)
[AWS AppSync adds support for custom response headers](https://aws.amazon.com/about-aws/whats-new/2022/02/aws-appsync-support-custom-response-headers/) [HTTP helpers in $util.http](https://docs.aws.amazon.com/appsync/latest/devguide/http-helpers-in-utils-http.html) [Resolver Mapping Template Programming Guide](https://docs.aws.amazon.com/appsync/latest/devguide/resolver-mapping-template-reference-programming-guide.html)

</details>

<details>
    <summary>Yoga</summary>

For GraphQL Yoga, you can use middleware to set the Cache-Control header. Here's an example using Express.js middleware:

</details>

<details>
    <summary>Graphqlgo</summary>

You can use a HTTP middleware to add security headers. For instance, with [srikrsna/security-headers](https://github.com/srikrsna/security-headers):

</details>

<details>
    <summary>Graphqlruby</summary>

In Ruby on Rails with GraphQL-Ruby, you can set the Cache-Control header in your controller actions:

</details>

<details>
    <summary>Hasura</summary>

For Hasura GraphQL engine, you can configure the Cache-Control header using environment variables or directly in the console under the 'Settings' tab:

</details>


### REST Specific

<details>
    <summary>Asp.net</summary>

In ASP.NET, use the HttpResponse object to set the Cache-Control header:

</details>

<details>
    <summary>Ruby on rails</summary>

In Ruby on Rails, set the Cache-Control header in your controller actions:

</details>

<details>
    <summary>Next.js</summary>

In Next.js API routes, you can set headers using the NextApiResponse object:

</details>

<details>
    <summary>Laravel</summary>

In Laravel, use the response object to set the Cache-Control header:

</details>

<details>
    <summary>Express.js</summary>

In Express.js, use the response object to set the Cache-Control header:

</details>

<details>
    <summary>Django</summary>

In Django, use the @never_cache decorator to set the Cache-Control header:

</details>

<details>
    <summary>Symfony</summary>

In Symfony, use the Response object to set the Cache-Control header:

</details>

<details>
    <summary>Spring boot</summary>

In Spring Boot, use HttpServletResponse to set the Cache-Control header:

</details>

<details>
    <summary>Flask</summary>

In Flask, use the response object to set the Cache-Control header:

</details>

<details>
    <summary>Nuxt</summary>

In Nuxt.js, you can set headers in the nuxtServerInit action or in middleware:

</details>

## Configuration

> Identifier: `protocol/header_cache_control`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "protocol/header_cache_control": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="low-severity">LOW</span>**

### Compliance

- OWASP: **[API7:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa7-server-side-request-forgery.md)**
- pci: **6.5.10**
- gdpr: **Article-32**


- iso27001: **A.14.2**
- nist: **SP800-53**


### Classification






### Score




## References

- [https://owasp.org/www-community/Security_Headers](https://owasp.org/www-community/Security_Headers)
  - [https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching)
  - [https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes.html)
  