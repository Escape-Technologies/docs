---
title: CORS
---

# CORS

## Description

Attackers can exploit CORS (Cross-Origin Resource Sharing) misconfigurations on the web server to perform CSRF (Cross-Site Request Forgery) attacks and send unauthorized commands from an authenticated user session.


## Remediation

Configure the `Access-Control-Allow-Origin` HTTP header to a more restrictive set of domains, or remove all CORS headers entirely, to allow the web browser to enforce the Same Origin Policy (SOP) in a more restrictive manner.

If your API is public and used in websites you don't control yourself, you want to allow any request origin and you can safely ignore this alert.

See: [enable-cors.org](https://enable-cors.org/index.html).



### GraphQL Specific

<details>
    <summary>Apollo</summary>

Configure the 'Access-Control-Allow-Origin' HTTP header to a more restrictive set of domains, or remove all CORS headers entirely, to allow the web browser to enforce the Same Origin Policy (SOP) in a more restrictive manner.For instance, with `apollo-server-express`, you can restrain request origin to only a few whitelisted domains:

</details>

<details>
    <summary>Yoga</summary>

Ensure that the CORS configuration for Yoga server is set to allow requests only from trusted origins. Use the CORS middleware to define the allowed origins.

</details>

<details>
    <summary>Awsappsync</summary>

Add CORS headers with the API Gateway.Put your AppSync API behind an API Gateway and configure it to act as a proxy to your AppSync endpoint (e.g., using the HTTP Proxy feature).To learn how to do so, see [AWS's API Gateway documentation](https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html). You can then manually enable CORS for each resource (only for one if you created the gateway for a single AppSync endpoint):API Gateway console > {your api gateway} > Resources > {your created resource} > Actions : Enable CORS

</details>

<details>
    <summary>Graphqlgo</summary>

For GraphQL servers using Go, configure the CORS middleware to restrict the 'Access-Control-Allow-Origin' header to trusted domains.

</details>

<details>
    <summary>Graphqlruby</summary>

In Ruby on Rails with GraphQL, set up CORS in the application configuration to only allow trusted domains.

</details>

<details>
    <summary>Hasura</summary>

Configure Hasura's CORS policy to restrict the 'Access-Control-Allow-Origin' header to trusted domains via the environment variables or the console settings.

</details>

## Configuration

> Identifier: `protocol/cors`



### Examples



#### Ignore this check

```json
{
    "checks": {
        "protocol/cors": {
            "skip": true
        }
    }
}
```




## Score

- Escape Severity: **<span className="low-severity">LOW</span>**

### Compliance

- OWASP: **[API7:2023](https://github.com/OWASP/API-Security/blob/master/editions/2023/en/0xa7-server-side-request-forgery.md)**
- pci: **6.5.9**
- gdpr: **Article-32**
- soc2: **CC6.1**
- psd2: **Article-95**
- iso27001: **A.14.2**
- nist: **SP800-53**
- fedramp: **AC-4**

### Classification






### Score

- CVSS_VECTOR: **CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:H/RL:O/RC:C**
- CVSS_SCORE: **5.1**

## References

- [https://portswigger.net/web-security/cors](https://portswigger.net/web-security/cors)
  